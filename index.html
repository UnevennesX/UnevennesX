<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Herramienta URL</title>
  <link rel="icon" type="image/png" href="https://cdn.dribbble.com/users/7549673/screenshots/17206704/media/1210a9d0ec8af427967e735935861eeb.png?resize=400x300&vertical=center" />



  <style>
    body {
        font-family: 'Poppins', Arial, sans-serif;
        background: linear-gradient(135deg, #1e1e1e, #2c2c2c);
        color: #eaeaea;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
        margin: 0;
        padding: 0;
        overflow-x: hidden; /* Evita el desplazamiento horizontal */
    }

    .container {
        background: #333333;
        padding: 20px;
        border-radius: 12px;
        box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
        width: 90%;
        max-width: 480px;
        text-align: center;
        overflow: auto; /* Permite el scroll si el contenido excede la altura */
    }

    h1 {
        font-size: 1.8rem;
        margin-bottom: 20px;
        color: #b6e3a1;
    }

    input[type="text"] {
        width: 90%;
        padding: 12px;
        margin: 10px 0;
        border: 1px solid #444444;
        border-radius: 8px;
        background: #444444;
        color: #f0f0f0;
        font-size: 16px;
    }

    input[type="text"]:focus {
        outline: none;
        border: 1px solid #b6e3a1;
        background: #555555;
    }

    button {
        background: #4caf50;
        color: #ffffff;
        padding: 12px 24px;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        font-size: 16px;
        font-weight: bold;
    }

    button:hover {
        background: #45a049;
    }

    .result {
        margin-top: 20px;
        padding: 12px;
        background: #444444;
        border: 1px solid #444444;
        border-radius: 8px;
        word-wrap: break-word;
        font-size: 14px;
        text-align: left;
        color: #f0f0f0;
        opacity: 0;
        animation: fadeIn 0.6s forwards;
    }

    @keyframes fadeIn {
        from {
            opacity: 0;
        }
        to {
            opacity: 1;
        }
    }

    .notification {
        margin-top: 10px;
        padding: 10px;
        background: #4caf50;
        color: #ffffff;
        font-size: 14px;
        font-weight: bold;
        border-radius: 8px;
        display: none;
        text-align: center;
    }

    .result .survey-name {
        font-size: 1.3em;
        color: #e0e0e0;
        margin-bottom: 15px;
    }

.result #notchLink {
    font-size: 1.2em;
    color: #007bff;
    cursor: pointer;
    text-decoration: underline;
    font-weight: 600;
    transition: color 0.3s ease, box-shadow 0.3s ease;
    padding: 10px;
    border-radius: 8px;
    word-wrap: break-word; /* Permite que el enlace se ajuste dentro del contenedor */
    white-space: normal; /* Evita que el enlace se salga de una sola línea */
    max-width: 100%; /* Asegura que no se desborde */
    overflow: hidden;
    text-overflow: ellipsis; /* Muestra '...' si el enlace es demasiado largo */
}


    .result #notchLink:hover {
        color: #0056b3;
        box-shadow: 0 0 8px rgba(0, 123, 255, 0.5);
    }

    #notchLink.copied {
        color: #28a745;
        animation: copiedAnimation 1s ease;
    }

    @keyframes copiedAnimation {
        0% {
            transform: scale(1.1);
        }
        50% {
            transform: scale(1);
        }
        100% {
            transform: scale(1.1);
        }
    }

    .hidden {
        display: none;
    }

    .error {
        margin-top: 10px;
        padding: 10px;
        background: #f44336;
        color: #ffffff;
        font-size: 14px;
        font-weight: bold;
        border-radius: 8px;
        display: none;
        text-align: center;
    }

    .allowed-domains {
        margin-top: 20px;
        background: #444444;
        padding: 8px;
        border-radius: 13px;
        color: #e0e0e0;
        font-size: 16px;
        text-align: left;
        list-style-type: none;
    }

    /* Mejoras específicas para dispositivos móviles */
    @media (max-width: 480px) {
        h1 {
            font-size: 1.6rem;
        }

        .container {
            padding: 15px;
        }

        input[type="text"], button {
            font-size: 14px;
            padding: 10px;
        }

        .result {
            font-size: 12px;
        }

        .allowed-domains {
            font-size: 14px;
        }

        /* Para asegurar que el contenido no haga scroll horizontal */
        body {

    display: flex;
    justify-content: center; /* Centra horizontalmente */
    height: 100vh; /* Asegura que el contenedor ocupe toda la altura */
    margin: 0; /* Elimina márgenes predeterminados */
    overflow-x: hidden; /* Evita el desplazamiento horizontal */
    overflow-y: hidden; /* Evita el desplazamiento vertical si el contenido cabe completamente */        }
    }


p {
    margin: 1;
    padding: 12px;
    background: #444444;
    border: 1px solid #444444;
    border-radius: 8px;
    word-wrap: break-word; /* Asegura que el texto largo se ajuste al contenedor */
    overflow-wrap: break-word; /* Igual que word-wrap, para asegurar que no haya desbordes */
    font-size: 14px;
    text-align: left;
    color: #f0f0f0;
    white-space: normal; /* Permite que el texto se rompa en varias líneas si es necesario */
    max-width: 100%; /* Impide que se desborde del contenedor */
    box-sizing: border-box; /* Asegura que el padding y el borde no afecten el tamaño total */
}


<style>

  .allowed-domains {
      background: #fff;
      border: 1px solid #ddd;
      border-radius: 8px;
      padding: 15px;
      max-width: 400px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      position: relative;
  

    }

    .allowed-domains h3 {
      margin-top: 0;
      font-size: 1.2em;
      color: #ffffff;
      justify-content: space-between;
      align-items: center;
      cursor: pointer;
      margin-block-end: auto;
      TEXT-ALIGN: center;

    }

    .allowed-domains h3:hover {
      color: #4caf50;
      
    }

    .allowed-domains ul {
      list-style: none;
      padding-left: 0;
      margin: 0;
      overflow: hidden;
      max-height: 0;
      transition: max-height 0.5s ease, opacity 0.5s ease;
      opacity: 0;
    }

    .allowed-domains.open ul {
      max-height: 500px; /* Suficiente para mostrar todos los elementos */
      opacity: 1;
    }

    .allowed-domains li {
      margin: 8px 0;
      font-size: 1em;
      color: #ffffff;
    }
  </style>
  

  </head>

  
<body>


  
  <div class="container">
    <h1>Armador de URLS v-1.2🆕</h1>

<form id="urlForm" autocomplete="off">
  <label for="urlInput">Ingresa la URL de la Survey: </label>
  <input type="text" id="urlInput" name="url" required placeholder="Ej. https://hanover-research.qualtrics.com/..." autocomplete="off">
  <button type="submit">Generar URL</button>
</form>

<h2 id="generatedTitle" class="hidden">URL Armado:</h2>
<p id="surveyName" class="hidden"></p>
<p id="generatedUrl" class="hidden"></p>
    
<p id="notification" class="notification hidden">¡URL Copiada Automáticamente!</p>
<p id="error" class="error hidden">¡Solo se permiten URLs válidas!</p>



    <div class="allowed-domains">
      <h3 onclick="toggleList()">✌️INFORMACIÓN DEL ARMADOR - ACTUAL✌️<span id="toggleText"></span></h3>
      <ul>
        <br>
        USA { <img src="https://upload.wikimedia.org/wikipedia/en/a/a4/Flag_of_the_United_States.svg" alt="USA Flag" width="24">
        <li class="extra">Samplicious > surveys.ovationworldpanel.com 🐐</li>
        <li class="extra">Samplicious > router.cint.com 🐐</li>
        <li class="extra">Interno > RDSECURED 👌</li><br><br>
        Canada { <img src="https://upload.wikimedia.org/wikipedia/commons/c/cf/Flag_of_Canada.svg" alt="Canada Flag" width="24">
        <li>Samplicious > hanover-research.qualtrics Check☠️</li>
        <li>Samplicious > vault.questionlab 👌</li>
        <li>Samplicious > lumen-research 👌</li>
        <li class="extra">Samplicious > surveys.audience-align 👌</li>
        <li class="extra">Samplicious > insights.surveynavigate 👌</li>
        <li class="extra">Invite-Mindshare > ipsosinteractive 👌</li>
        <li class="extra">Sample-Cube > surveys.sago 👌</li>}
      </ul>
    </div>
  </div>

























<script>




// Definir la URL donde se encuentra el archivo .txt
const DATA_FILE_URL = 'https://raw.githubusercontent.com/UnevennesX/UnevennesX/main/datos-info.txt';

// Función para cargar los datos del archivo
async function fetchSurveyData() {
  const response = await fetch(DATA_FILE_URL);
  if (!response.ok) {
    throw new Error('Error al obtener el archivo');
  }
  return response.text();
}

// Función para procesar la URL ingresada y extraer el RID
function extractRid(url, isSamplicious) {
  try {
    const parsedUrl = new URL(url);

    // Si existe un parámetro explícito llamado RID, úsalo
    const rid = parsedUrl.searchParams.get('RID');
    if (rid) {
      return rid;
    }

    // Si es de tipo Samplicious, busca un valor que comience con "67"
    if (isSamplicious) {
      const allParts = [parsedUrl.pathname, ...parsedUrl.searchParams.values()];
      const match = allParts.find(part => part.startsWith('67'));
      if (match) {
        return match;
      }
    }

    // Si no se encuentra un RID, devuelve null
    return null;
  } catch (error) {
    console.error('Error al extraer el RID:', error);
    return null;
  }
}

// Función principal para generar la nueva URL
async function generateSurveyUrl(inputUrl) {
  try {
    // Cargar datos del archivo
    const fileData = await fetchSurveyData();

    // Dividir el archivo en encuestas
    const surveys = fileData.split('----------------').map(entry => {
      const lines = entry.trim().split('\n');
      const survey = {};
      lines.forEach(line => {
        const [key, value] = line.split(': ').map(item => item.trim());
        if (key && value) {
          survey[key.toLowerCase()] = value;
        }
      });
      return survey;
    });

    // Procesar la URL ingresada
    const parsedUrl = new URL(inputUrl);
    const domain = parsedUrl.hostname.replace('www.', ''); // Eliminar el "www." si está presente

    // Buscar la encuesta correspondiente al dominio o nombre (búsqueda parcial)
    const targetSurvey = surveys.find(survey =>
      (survey['nombre']?.toLowerCase().includes(domain.toLowerCase())) || 
      (survey['url']?.includes(domain))
    );

    if (!targetSurvey) {
      throw new Error('No se encontró ninguna encuesta para este dominio.');
    }

    // Determinar si es de tipo Samplicious
    const isSamplicious = targetSurvey['tipo de survey']?.toLowerCase() === 'samplicious';

    // Extraer el RID
    const rid = extractRid(inputUrl, isSamplicious);
    if (!rid) {
      throw new Error('No se pudo extraer un RID válido.');
    }

    // Extraer el token desde la URL del archivo TXT
    const urlTemplate = targetSurvey.url;
    const tokenMatch = urlTemplate.match(/token=([a-f0-9-]+)/);
    const token = tokenMatch ? tokenMatch[1] : null;

    if (!token) {
      throw new Error('No se encontró un token válido en los datos del archivo.');
    }

    // Verificar si el token está antes o después del RID
    let generatedUrl = '';
    if (urlTemplate.indexOf('RID=') < urlTemplate.indexOf('token=')) {
      // RID antes del token
      generatedUrl = `https://notch.insights.supply/cb?RID=${rid}&token=${token}`;
    } else {
      // Token antes del RID
      generatedUrl = `https://notch.insights.supply/cb?token=${token}&RID=${rid}`;
    }

    return { generatedUrl, surveyName: targetSurvey['nombre'] };
  } catch (error) {
    console.error('Error generando la URL:', error);
    throw new Error('¡Solo se permiten URLs válidas!');
  }
}

// Función para manejar el formulario y mostrar el resultado
document.getElementById('urlForm').addEventListener('submit', async (event) => {
  event.preventDefault();

  const urlInput = document.getElementById('urlInput').value;
  const generatedTitle = document.getElementById('generatedTitle');
  const generatedUrlElement = document.getElementById('generatedUrl');
  const surveyNameElement = document.getElementById('surveyName'); // Elemento para mostrar el nombre de la encuesta
  const notification = document.getElementById('notification');
  const errorElement = document.getElementById('error');

  try {
    // Generar la URL
    const { generatedUrl, surveyName } = await generateSurveyUrl(urlInput);

    // Mostrar la URL generada
    generatedTitle.classList.remove('hidden');
    generatedUrlElement.classList.remove('hidden');
    generatedUrlElement.textContent = generatedUrl;

    // Mostrar el nombre de la encuesta
    surveyNameElement.classList.remove('hidden');
    surveyNameElement.textContent = `Token generado de la encuesta: ${surveyName}`;

    // Mostrar la notificación de copiado (si corresponde)
    notification.classList.remove('hidden');
    setTimeout(() => notification.classList.add('hidden'), 2000);

    // Limpiar errores
    errorElement.classList.add('hidden');
  } catch (error) {
    // Mostrar error si ocurre
    generatedTitle.classList.add('hidden');
    generatedUrlElement.classList.add('hidden');
    surveyNameElement.classList.add('hidden');
    errorElement.textContent = error.message;
    errorElement.classList.remove('hidden');
  }
});


  


</script>













  



</body>

  
</html>
